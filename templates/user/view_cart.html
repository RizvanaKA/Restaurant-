{% extends 'user/user_index.html' %}
{% block body %}
<style>
  /* --- Theme colors (homepage-like) --- */
  :root{
    --primary:#0b5ed7;        /* deep blue */
    --primary-600:#0a58ca;
    --accent:#00b894;         /* subtle accent (green) */
    --muted:#6c757d;
    --card-bg: linear-gradient(180deg, rgba(11,94,215,0.03), #ffffff 36%);
  }

  /* --- Layout --- */
  .cards-wrap { padding: 1.5rem 0; }
  .cart-title { display:flex; align-items:center; gap:.6rem; }

  /* --- Card --- */
  .food-card {
    border-radius: 1rem;
    overflow: hidden;
    background: var(--card-bg);
    border: 1px solid rgba(11,94,215,0.06);
    transition: transform .22s cubic-bezier(.2,.9,.2,1), box-shadow .22s ease, filter .18s ease;
    box-shadow: 0 8px 18px rgba(11,94,215,0.04);
    height: 100%;
    position: relative;
  }
  .food-card::after{
    content:'';
    position:absolute;
    inset:0;
    pointer-events:none;
    border-radius:1rem;
    transition:opacity .22s ease;
    opacity:0;
    background: linear-gradient(180deg, transparent, rgba(11,94,215,0.02));
  }
  .food-card:hover{
    transform: translateY(-8px) scale(1.01);
    box-shadow: 0 20px 44px rgba(11,94,215,0.12);
    filter: saturate(1.02);
  }
  .food-card:hover::after{ opacity:1; }

  .food-body {
    padding: 1rem;
    display: flex;
    flex-direction: column;
    gap:.5rem;
    height:100%;
  }

  .food-title { margin:0 0 .25rem 0; font-size:1.04rem; font-weight:700; color:#12243b; }
  .food-meta { color:var(--muted); font-size:.9rem; margin-bottom:.5rem; }

  .price { color:var(--primary); font-weight:800; font-size:1.04rem; }
  .qty { color:#495057; font-size:.95rem; }

  .food-footer {
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-top:auto;
    gap:.5rem;
  }

  /* --- Remove button --- */
  .btn-remove {
    border-radius:.7rem;
    padding:.4rem .7rem;
    font-size:.9rem;
    border:1px solid rgba(220,53,69,0.12);
    background: linear-gradient(180deg,#fff,#fff);
    color:#C59560;
    transition: transform .14s ease, box-shadow .14s ease, background .14s ease;
  }
  .btn-remove:hover{
    transform: translateY(-3px);
    box-shadow: 0 10px 24px rgba(214,51,132,0.08);
    background: linear-gradient(180deg,#fff,#fff);
  }

  /* --- Item badge / id --- */
  .item-id { font-size:.82rem; color:var(--muted); }

  /* --- Checkout card --- */
  .checkout-card {
    border-radius: 1rem;
    overflow: hidden;
    background: var(--card-bg);
    border: 1px solid rgba(11,94,215,0.06);
    box-shadow: 0 10px 28px rgba(11,94,215,0.05);
    padding: 1rem;
  }

  .checkout-amt { font-size:1.36rem; font-weight:800; color:var(--primary); }

  /* --- Pay button (animated) --- */
  .btn-pay {
    --g1: linear-gradient(90deg,  #FCB53B, #C59560);
    --g2: linear-gradient(90deg,  #FCB53B, #C59560);
    border: none;
    color: #fff;
    padding:.65rem 1rem;
    font-size:1.02rem;
    border-radius:.85rem;
    cursor:pointer;
    background: var(--g1);
    box-shadow: 0 10px 30px rgba(11,94,215,0.12);
    transform: translateZ(0);
    transition: transform .18s cubic-bezier(.2,.9,.2,1), box-shadow .18s ease, background .22s ease;
    position: relative;
    overflow: hidden;
  }
  .btn-pay:hover{
    transform: translateY(-4px) scale(1.01);
    box-shadow: 0 20px 46px rgba(11,94,215,0.16);
    background: var(--g2);
  }
  .btn-pay:active{ transform: translateY(-2px) scale(.996); }

  /* subtle sheen animation */
  .btn-pay::after{
    content:'';
    position:absolute;
    left:-40%;
    top:0;
    width:40%;
    height:100%;
    background: linear-gradient(120deg, rgba(255,255,255,0.12), rgba(255,255,255,0.04), rgba(255,255,255,0));
    transform: skewX(-18deg);
    transition: left .9s ease;
  }
  .btn-pay:hover::after{ left:120%; transition:left .9s ease; }

  /* small pay-pill (amount) */
  .pay-pill {
    background: rgba(255,255,255,0.06);
    padding:.35rem .6rem;
    border-radius:.6rem;
    color:#fff;
    font-weight:700;
    margin-left:.6rem;
    font-size:.95rem;
  }

  /* responsive: 4 per row on lg, 3 md, 2 sm */
  @media (min-width: 1200px){
    .col-lg-3 { width: 25%; }
  }
  @media (max-width: 991.98px){
    .col-md-6 { width: 50%; }
  }
  @media (max-width: 575.98px){
    .col-12 { width: 100%; }
  }
</style>

<div class="container cards-wrap">
  <div class="d-flex justify-content-between align-items-center mb-3 cart-title">
    <h2 class="mb-0">ðŸ›’ Your Cart</h2>
  </div>

  {% if not cart_main or subs|length == 0 %}
    <div class="alert alert-info">Your cart is empty.</div>
  {% else %}
    <div class="row g-3">
      {% for s in subs %}
        <div class="col-12 col-md-6 col-lg-3">
          <div class="card food-card h-100 border-0">
            <div class="food-body">
              <h5 class="food-title">{{ s.FOOD.name }}</h5>
              <div class="food-meta">{{ s.FOOD.category|default:"" }}</div>

              <div>
                <div><span class="price">â‚¹{{ s.FOOD.price }}</span></div>
                <div class="qty">Qty: {{ s.quantity }}</div>
                <div class="mt-2"><strong>Amount:</strong> â‚¹{{ s.amount }}</div>
              </div>

              <div class="food-footer">
                <form action="/myapp/remove_cart_item/{{ s.id }}/" method="post" style="margin:0;">
                  {% csrf_token %}
                  <button class="btn-remove" type="submit">Remove</button>
                </form>

                <div class="text-end">
                  <div class="item-id">Item</div>
                  <div class="fw-semibold">#{{ s.id }}</div>
                </div>
              </div>
            </div>

            <div class="px-3 pb-3 text-end">
              <small class="text-muted">Order # {% if s.ORDERMAIN and s.ORDERMAIN.id %}{{ s.ORDERMAIN.id }}{% else %}â€”{% endif %}</small>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <div class="mt-4">
      <div class="checkout-card d-flex justify-content-between align-items-center flex-wrap">
        <div>
          <p class="mb-1"><strong>Total Items:</strong> {{ cart_main.quantity }}</p>
          <p class="mb-0"><strong>Order Total:</strong> <span class="checkout-amt">â‚¹{{ cart_main.amount }}</span></p>
        </div>

        <div class="mt-3 mt-sm-0 d-flex align-items-center">
          <a href="/myapp/raz_pay/{{ cart_main.amount }}/{{ cart_main.id }}/" class="btn-pay d-inline-flex align-items-center">
            <span>Pay Now</span>
            <span class="pay-pill">â‚¹{{ cart_main.amount }}</span>
          </a>
        </div>
      </div>
    </div>
  {% endif %}
</div>
{% endblock %}
